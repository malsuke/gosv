package domain

import (
	"github.com/google/go-github/v77/github"
	osvapi "github.com/malsuke/govs/internal/osv/api"
)

type Vulnerability struct {
	ID              string
	RepositoryOwner string
	RepositoryName  string
	Details         osvapi.OsvVulnerability
	Predicted       *Predicted
	SuspectedPR     []*github.PullRequest
	SuspectedCommit []*github.Commit
}

func (v Vulnerability) RepositoryFullName() string {
	if v.RepositoryOwner == "" || v.RepositoryName == "" {
		return ""
	}
	return v.RepositoryOwner + "/" + v.RepositoryName
}
